---
title: "Utilities"
description: "Helper functions for tree manipulation and validation"
---

Use these utility functions when building custom logic or manipulating the document tree programmatically.

## Tree Operations

```tsx
import { createNode, findNode } from "@open-email/editor";
```

<ResponseField
  name="createNode"
  type="(type, props?, children?, id?) => EmailNode"
>
  Creates a new node object. If `id` is omitted a unique ID is generated
  automatically. Pass a fixed `id` when you need deterministic output (e.g. SSR
  / hydration-safe initial documents).
</ResponseField>

<ResponseField name="cloneNode" type="(node) => EmailNode">
  Deeply clones a node and its children, generating new IDs for all.
</ResponseField>

<ResponseField name="findNode" type="(root, id) => EmailNode | null">
  Finds a node by ID within a tree.
</ResponseField>

<ResponseField name="findParent" type="(root, id) => EmailNode | null">
  Finds the parent of a given node ID.
</ResponseField>

<ResponseField name="flattenTree" type="(root) => EmailNode[]">
  Returns an array of all nodes in the tree.
</ResponseField>

## Document Management

<ResponseField name="createEmptyDocument" type="(title?) => EmailDocument">
  Creates a fresh document with a default structure (Container > Section > Text).
</ResponseField>

<ResponseField name="validateDocument" type="(doc) => string[]">
  Checks a document for errors (missing required fields, duplicate IDs, etc.).
  Returns an array of error messages.
</ResponseField>

<ResponseField name="getNodePath" type="(node, root) => number[]">
  Returns the path of indices from the root to the node.
</ResponseField>

<ResponseField name="generateId" type="(prefix?) => string">
  Generates a unique ID for a node.
</ResponseField>

## Registry Utilities

```tsx
import {
  defaultRegistry,
  createRegistry,
  mergeRegistries,
  getComponentsByCategory,
  getComponentDef,
  getAISchema,
} from "@open-email/editor";
// or from "@open-email/editor/server" in server code
```

<ResponseField name="defaultRegistry" type="ComponentRegistry">
  The built-in registry containing all default components. A `Map<EmailNodeType, ComponentDefinition>`.
</ResponseField>

<ResponseField name="createRegistry" type="(definitions: ComponentDefinition[]) => ComponentRegistry">
  Creates a new registry from an array of component definitions.
</ResponseField>

<ResponseField name="mergeRegistries" type="(base, overrides) => ComponentRegistry">
  Merges custom component definitions on top of a base registry. Use this to add your own components while keeping all defaults.
</ResponseField>

<ResponseField name="getComponentsByCategory" type="(registry) => Record<string, ComponentDefinition[]>">
  Groups all components in the registry by their `category` field.
</ResponseField>

<ResponseField name="getComponentDef" type="(registry, type) => ComponentDefinition | undefined">
  Looks up a single component definition by its type string.
</ResponseField>

<ResponseField name="getAISchema" type="(registry?) => AIDocumentSchema">
  Returns a fully self-describing schema of every component and document-level
  field. Pass this to an LLM system prompt so it can generate valid
  `EmailDocument` JSON. See [AI Integration](/core/ai-integration) for a full
  walkthrough.
</ResponseField>

## Variable Interpolation

These utilities help you work with template variables (`{{variableName}}`).

```tsx
import {
  interpolateVariables,
  hasVariables,
  extractVariableNames
} from "@open-email/editor";
```

<ResponseField name="interpolateVariables" type="(content, variableData?, variableDefinitions?) => string">
  Replaces `{{variableName}}` placeholders in a string with values from `variableData` or fallbacks from `variableDefinitions`. Returns the interpolated string.
</ResponseField>

<ResponseField name="hasVariables" type="(content: string) => boolean">
  Checks if a string contains any variable placeholders matching the `{{variableName}}` pattern.
</ResponseField>

<ResponseField name="extractVariableNames" type="(content: string) => string[]">
  Extracts all unique variable names from a string. For example, `"Hello {{name}}, your code is {{code}}"` returns `["name", "code"]`.
</ResponseField>
